# ESP32 Audio Delay Project - 测试验证

## 功能测试清单

### 1. 硬件连接测试
- [ ] ESP32-LyraT-Mini 板正常上电
- [ ] OLED 显示屏正常显示
- [ ] EC11 编码器响应正常
- [ ] 音频输入输出接口连接正常

### 2. 显示功能测试
- [ ] OLED 初始化成功
- [ ] 主界面显示正常（标题、延迟时间、采样率）
- [ ] 菜单界面显示正常
- [ ] 字符显示清晰，反转显示正常

### 3. 用户交互测试
- [ ] 编码器旋转检测正常
- [ ] 编码器按压检测正常
- [ ] 延迟时间调整功能正常
- [ ] 菜单导航功能正常
- [ ] 采样率选择功能正常

### 4. 音频处理测试
- [ ] I2S 音频接口初始化成功
- [ ] 音频输入采集正常
- [ ] 音频输出播放正常
- [ ] 延迟效果可听到
- [ ] 不同采样率切换正常

### 5. 设置管理测试
- [ ] NVS 存储初始化成功
- [ ] 设置保存功能正常
- [ ] 设置加载功能正常
- [ ] 重启后设置恢复正常
- [ ] 自动保存功能正常

### 6. 系统稳定性测试
- [ ] 长时间运行稳定
- [ ] 内存使用正常
- [ ] 任务调度正常
- [ ] 无死锁或崩溃

## 测试步骤

### 基本功能测试
1. **上电测试**
   - 连接硬件并上电
   - 观察 OLED 显示屏是否正常显示主界面
   - 检查串口日志输出

2. **延迟调整测试**
   - 旋转编码器调整延迟时间
   - 观察显示屏数值变化
   - 连接音频设备测试延迟效果

3. **菜单操作测试**
   - 按压编码器进入菜单
   - 旋转编码器选择不同采样率
   - 按压确认选择并返回主界面

4. **设置保存测试**
   - 修改延迟时间和采样率
   - 等待5秒自动保存
   - 重启设备验证设置恢复

### 音频质量测试
1. **延迟精度测试**
   - 设置不同延迟值
   - 使用音频分析工具测量实际延迟
   - 验证延迟精度在±1ms范围内

2. **音频质量测试**
   - 测试不同采样率下的音频质量
   - 检查是否有噪音或失真
   - 验证音频连续性

## 预期结果

### 正常工作状态
- OLED 显示清晰，界面响应流畅
- 编码器操作灵敏，无误触发
- 音频延迟效果明显且稳定
- 设置保存和恢复功能正常
- 系统运行稳定，无异常重启

### 性能指标
- 延迟范围：0-10000ms
- 延迟精度：±1ms
- 支持采样率：44.1/48/96/192 kHz
- 响应时间：<100ms
- 内存使用：<80% SRAM

## 故障排除

### 常见问题及解决方案

1. **OLED 无显示**
   - 检查 I2C 连接
   - 验证电源供应
   - 确认 I2C 地址设置

2. **编码器无响应**
   - 检查 GPIO 连接
   - 验证上拉电阻
   - 检查防抖设置

3. **音频无输出**
   - 检查 I2S 配置
   - 验证音频连接
   - 确认采样率设置

4. **设置不保存**
   - 检查 NVS 分区
   - 验证存储权限
   - 确认自动保存逻辑

## 测试环境

### 硬件环境
- ESP32-LyraT-Mini V1.2
- EC11 编码器模块
- 0.96" OLED 显示屏 (SSD1306)
- 音频测试设备

### 软件环境
- ESP-IDF v4.4+
- 开发工具链
- 串口监控工具
- 音频分析软件

## 测试报告模板

```
测试日期：____
测试人员：____
硬件版本：____
软件版本：____

功能测试结果：
□ 通过 □ 失败 - 显示功能
□ 通过 □ 失败 - 用户交互
□ 通过 □ 失败 - 音频处理
□ 通过 □ 失败 - 设置管理
□ 通过 □ 失败 - 系统稳定性

问题记录：
1. ________________
2. ________________
3. ________________

总体评价：
□ 优秀 □ 良好 □ 一般 □ 需改进

备注：
________________
```
